---
title: "Volatiles - EDA"
author: "Javiera Rudolph"
date: "5/17/2019"
output:
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
knitr::opts_chunk$set(echo = FALSE, message = FALSE)

library(tidyverse)
```

The original raw data excel file (LK_CompositeData_w_Partial_Flux_Final.xlsx) is fairly complicated. It has multiple sheets, references and calculations. The first sheet is the one that contains all of the data. So, I tried importing that one using the `readxl::read_xlsx` function but it failed to import. There must have been some formatting issue. I opted to use `read_csv` and transform the first sheet of the excel data into a csv file. I couldn't delete any of the morphological traits since it change the references for the volatile data. I just left it as is, removed all formating with colors, highlights, merged cells and removed the first explanatory row. All of this was done by hand and not scripted. 


```{r}
rawdata <- read_csv("rawdata/20190517_JR_fromLKcompData.csv")
# names(rawdata)
# select only the family, sample name and the volatiles
voldata <- rawdata[,c(1,2,54:234)]
dim(voldata)
```

The dimmensions associated to this don't make much sense because I was under the impression that there were 600ish samples. There must be some NAs or blank cells in here.

```{r}
head(colSums(is.na(voldata)))
```
This tells me thera re more than 700 values with NAs in the dataframe. We are going to remove all the ones with NAs in the Family, because those are probably just remnants from excels autofill or something like that. 

```{r}
voldata <- voldata %>% 
  drop_na(`Fam #`) %>% 
  select(-`Sample_name_double check`)
head(voldata)
```


Now, we have a total of `r nrow(voldata)` observations, from which there are `r nrow(unique(voldata[,1]))` families and `r nrow(unique(voldata[,2]))` samples.

I'm going to rename the columns to make the work easier and with this, I'll create a key of names for the volatiles.

```{r}
volkey <- tibble(compound = names(voldata)[3:182],
                     keyname = paste0("v", stringr::str_pad(1:180,
                                                            width = 3, side = "left",
                                                            pad = 0)))

names(voldata) <- c("fam", "sample_id", volkey$keyname)

```

So far, the name key and the data are ready to start exploring.






Some of the questions that arise from this dataset (which is only including volatiles and identifier, no sex is included):
 - What does the *Sample Name* stand for? And how many of each should we have. Some seem to be repeated numbers, but not all. 
 - What does the name of each volatile correspond to? What is the difference between **FLUX** and **(Conc)2**? Are they in any specific units?
 
```{r}
# There seem to be way too many rows for the data set I thought we had. 
```
 
